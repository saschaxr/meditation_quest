<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedback Survey</title>
    <style>
        body { font-family: sans-serif; background: #222; color: white; text-align: center; padding: 15px; }
        .container { max-width: 600px; margin: 0 auto; }
        
        h1 { color: #ffc107; font-size: 1.8em; margin-bottom: 20px; }
        
        /* Sprachauswahl am Anfang */
        #lang-select { margin-top: 50px; }
        .lang-btn { background: #555; color: white; font-size: 1.2em; padding: 20px 30px; border: none; border-radius: 10px; cursor: pointer; margin: 10px; min-width: 200px; }
        .lang-btn:hover { background: #777; }

        /* Fragebogen */
        .question-box { margin-bottom: 25px; border-bottom: 1px solid #444; padding-bottom: 20px; }
        .question-text { font-weight: bold; font-size: 1.1em; display: block; margin-bottom: 15px; }
        
        button.ans-btn { padding: 12px 18px; margin: 8px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; min-width: 110px; transition: opacity 0.2s; }
        button.ans-btn:hover { opacity: 0.8; }
        
        .btn-yes { background-color: #28a745; color: white; } 
        .btn-maybe { background-color: #ffc107; color: black; } 
        .btn-no { background-color: #dc3545; color: white; } 
        
        #thanks { display: none; color: #ffc107; font-size: 1.5em; margin-top: 50px; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1 id="main-title">Ihre Meinung / Your opinion</h1>

    <div id="lang-select">
        <button class="lang-btn" onclick="startSurvey('de')">Deutsch ðŸ‡©ðŸ‡ª</button>
        <button class="lang-btn" onclick="startSurvey('en')">English ðŸ‡¬ðŸ‡§</button>
    </div>

    <div id="survey" class="hidden">
        <div class="question-box">
            <span id="q1-text" class="question-text"></span>
            <button class="ans-btn btn-yes" onclick="saveAnswer(1, 'a1')"><span class="a1"></span></button>
            <button class="ans-btn btn-maybe" onclick="saveAnswer(1, 'a2')"><span class="a2"></span></button>
            <button class="ans-btn btn-no" onclick="saveAnswer(1, 'a3')"><span class="a3"></span></button>
        </div>

        <div class="question-box">
            <span id="q2-text" class="question-text"></span>
            <button class="ans-btn btn-yes" onclick="saveAnswer(2, 'a1')"><span class="a1"></span></button>
            <button class="ans-btn btn-maybe" onclick="saveAnswer(2, 'a2')"><span class="a2"></span></button>
            <button class="ans-btn btn-no" onclick="saveAnswer(2, 'a3')"><span class="a3"></span></button>
        </div>

        <div class="question-box">
            <span id="q3-text" class="question-text"></span>
            <button class="ans-btn btn-yes" onclick="saveAnswer(3, 'y')"><span class="y-text"></span></button>
            <button class="ans-btn btn-no" onclick="saveAnswer(3, 'n')"><span class="n-text"></span></button>
        </div>

        <div class="question-box" style="border:none;">
            <span id="q4-text" class="question-text"></span>
            <button class="ans-btn btn-yes" onclick="saveAnswer(4, 'y', true)"><span class="y-text"></span></button>
            <button class="ans-btn btn-no" onclick="saveAnswer(4, 'n', true)"><span class="n-text"></span></button>
        </div>
    </div>

    <div id="thanks"></div>
</div>

<script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbwPQEVTV7u4VHnLSUXjfJoqOpq3djLD9r60U52Tp6a6hiPCW1GjvRtyNS5ZWLW5s-jG/exec"; 
    
    let currentLang = 'de';
    let antworten = { frage1: "", frage2: "", frage3: "", frage4: "", sprache: "" };

    const translations = {
        de: {
            q1: "1. FÃ¼hlen Sie sich jetzt weniger gestresst als vor der Meditation?",
            q2: "2. Hat Ihnen die Meditation geholfen, sich zu entspannen?",
            q3: "3. WÃ¼rden Sie erneut eine Meditation durchfÃ¼hren?",
            q4: "4. WÃ¼rden Sie diese Erfahrung weiterempfehlen?",
            a1: "Auf jeden Fall", a2: "Eher ja", a3: "Eher nein",
            y: "Ja", n: "Nein",
            sending: "Sende Daten...", done: "Vielen Dank fÃ¼r dein Feedback!", error: "Fehler beim Senden."
        },
        en: {
            q1: "1. Do you feel less stressed now than before the meditation?",
            q2: "2. Did the meditation help you to relax?",
            q3: "3. Would you do a meditation like this again?",
            q4: "4. Would you recommend this experience to others?",
            a1: "Definitely", a2: "Rather yes", a3: "Rather no",
            y: "Yes", n: "No",
            sending: "Sending data...", done: "Thank you for your feedback!", error: "Error sending data."
        }
    };

    function startSurvey(lang) {
        currentLang = lang;
        antworten.sprache = lang;
        
        // Texte setzen
        document.getElementById('q1-text').innerText = translations[lang].q1;
        document.getElementById('q2-text').innerText = translations[lang].q2;
        document.getElementById('q3-text').innerText = translations[lang].q3;
        document.getElementById('q4-text').innerText = translations[lang].q4;
        
        document.querySelectorAll('.a1').forEach(el => el.innerText = translations[lang].a1);
        document.querySelectorAll('.a2').forEach(el => el.innerText = translations[lang].a2);
        document.querySelectorAll('.a3').forEach(el => el.innerText = translations[lang].a3);
        document.querySelectorAll('.y-text').forEach(el => el.innerText = translations[lang].y);
        document.querySelectorAll('.n-text').forEach(el => el.innerText = translations[lang].n);
        
        // Wechseln
        document.getElementById('lang-select').classList.add('hidden');
        document.getElementById('survey').classList.remove('hidden');
    }

    function saveAnswer(qNum, key, isLast = false) {
        antworten["frage" + qNum] = translations[currentLang][key];
        
        // Optische Deaktivierung der beantworteten Frage
        const boxes = document.querySelectorAll('.question-box');
        boxes[qNum-1].style.opacity = "0.3";
        boxes[qNum-1].style.pointerEvents = "none";

        if (isLast) {
            sendData();
        }
    }

    async function sendData() {
        document.getElementById('survey').classList.add('hidden');
        const thanksDiv = document.getElementById('thanks');
        thanksDiv.innerText = translations[currentLang].sending;
        thanksDiv.style.display = 'block';

        try {
            await fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify(antworten),
                headers: { 'Content-Type': 'application/json' }
            });
            thanksDiv.innerText = translations[currentLang].done;
            
            // Automatischer Reset nach 4 Sekunden fÃ¼r den nÃ¤chsten Nutzer
            setTimeout(() => { location.reload(); }, 4000);
        } catch (e) {
            thanksDiv.innerText = translations[currentLang].error;
        }
    }
</script>

</body>
</html>